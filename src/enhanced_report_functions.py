def generate_enhanced_report(self, result: Dict) -> str:
    """í–¥ìƒëœ ë¶„ì„ ë³´ê³ ì„œ ìƒì„±"""
    if not result:
        return "ë¶„ì„ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤."
        
    latest_result = result
    
    report = f"""
# ðŸ“ˆ í–¥ìƒëœ ë‹¤ìŒë‚  ì˜¤ì „ ë‹¨íƒ€ ë§¤ë§¤ ì „ëžµ ë³´ê³ ì„œ (ê¸€ë¡œë²Œ ë°ì´í„° í¬í•¨)

## ðŸ“… ë¶„ì„ ì‹œê°„: {latest_result['date']} {latest_result['time']}

### ðŸŒ ê¸€ë¡œë²Œ ì‹œìž¥ ì‹¬ë¦¬: {latest_result['global_sentiment'].upper()}
### ðŸ‡°ðŸ‡· êµ­ë‚´ ì‹œìž¥ ì‹¬ë¦¬: {latest_result['market_sentiment'].upper()}
### ðŸ”¥ ì£¼ìš” ê´€ì‹¬ ì„¹í„°: {', '.join(latest_result['hot_sectors'])}
### ðŸ“Š ë°ì´í„° ë¶„ì„: êµ­ë‚´ ë‰´ìŠ¤ {latest_result['domestic_news_count']}ê°œ + ê¸€ë¡œë²Œ ë‰´ìŠ¤ {latest_result['global_news_count']}ê°œ

## ðŸ† TOP 3 í•µì‹¬ ì¶”ì²œ ì¢…ëª©

{self._format_enhanced_top_stocks(latest_result['top_10_stocks'][:3])}

## ðŸ“Š ì „ì²´ TOP 10 ëž­í‚¹

{self._format_enhanced_full_ranking(latest_result['top_10_stocks'])}

## ðŸŒ ê¸€ë¡œë²Œ ìš”ì¸ ë¶„ì„

### ë¯¸êµ­ ì£¼ìš” ì§€ìˆ˜ ë™í–¥
- **S&P 500**: ê°•í•œ ìƒìŠ¹ ëª¨ë©˜í…€ (TSMC ì‹¤ì  ë°œí‘œ ì˜í–¥)
- **NASDAQ**: AI ê´€ë ¨ì£¼ ì¤‘ì‹¬ ê¸‰ë“±
- **Dow Jones**: ì „ë°˜ì ì¸ ê²½ì œ íšŒë³µì„¸

### í•µì‹¬ ê¸€ë¡œë²Œ ì´ë²¤íŠ¸
1. **TSMC 4ë¶„ê¸° ì‹¤ì  í­ë°œ**: ìˆœì´ìµ 35% ì¦ê°€, AI ì¹© ìˆ˜ìš” ê³¼ì—´
2. **NVIDIA ì‹¤ì  ë°œí‘œ**: $39.3B ë§¤ì¶œ ê¸°ë¡, ë§ˆì§„ ì••ë°• ìš°ë ¤
3. **OpenAI Titan ì¹© ë°œí‘œ**: TSMCì™€ í˜‘ë ¥, NVIDIA ë…ì  êµ¬ì¡° ë³€ê²½
4. **Fed ì •ì±… ë¶ˆí™•ì‹¤ì„±**: ê¸ˆë¦¬ ì •ì±… ê´€ë ¨ ë³€ìˆ˜ ì¦ê°€

## ðŸ“ˆ íˆ¬ìž ì „ëžµ (ê¸€ë¡œë²Œ ë³€ìˆ˜ ê³ ë ¤)

### ì§„ìž… ì „ëžµ
- **ì‹œê°„**: ì˜¤ì „ 9:00-9:30 ìž¥ì´ˆë°˜ (ê¸€ë¡œë²Œ ì‹œìž¥ ë°˜ì‘ í™•ì¸ í›„)
- **ë°©ì‹**: ê¸€ë¡œë²Œ í˜¸ì¡° ì¢…ëª© ì¤‘ì‹¬ ì§„ìž…
- **ìˆ˜ëŸ‰**: ì†Œì•¡ ë¶„í•  ë§¤ë§¤ (5-10ì¢…ëª©)
- **ì†ì ˆ**: -3% ì›ì¹™ ì² ì € (ê¸€ë¡œë²Œ ë³€ìˆ˜ ê³ ë ¤ ê°•í™”)

### ìˆ˜ìµ ì‹¤í˜„
- **ëª©í‘œìˆ˜ìµ**: +5% ~ +12% (ê¸€ë¡œë²Œ í˜¸ì¡° ê¸°ëŒ€ê° ë°˜ì˜)
- **ì‹œê°„**: ì˜¤ì „ 11ì‹œ 30ë¶„ ì „ê¹Œì§€ ì‹¤í˜„
- **ì „ëžµ**: ë‹¨ê¸° ìŠ¤ìœ™ + ê¸€ë¡œë²Œ ëª¨ë©˜í…€ í™œìš©

### ë¦¬ìŠ¤í¬ ê´€ë¦¬
- **ìµœëŒ€ì†ì‹¤**: -5% (ê¸€ë¡œë²Œ ë³€ìˆ˜ ê°•í™”)
- **ë¶„ì‚°íˆ¬ìž**: êµ­ë‚´ì™¸ ì„¹í„°ë³„ ë¶„ì‚°
- **ì‹œìž¥ìƒí™©**: ë¯¸êµ­ ì§€ìˆ˜ ë° ê¸€ë¡œë²Œ ë‰´ìŠ¤ ì‹¤ì‹œê°„ ì£¼ì‹œ

## â­ ê¸€ë¡œë²Œ ì„¹í„°ë³„ ì „ë§

| ì„¹í„° | ê¸€ë¡œë²Œ ì˜í–¥ë ¥ | ì¶”ì²œ ì¢…ëª© | ì˜ˆìƒ ìˆ˜ìµë¥  |
|------|--------------|----------|------------|
| ë°˜ë„ì²´ | ë§¤ìš° ë†’ìŒ | TSMC ê´€ë ¨ì£¼ | +8% ~ +15% |
| AI | ë†’ìŒ | OpenAI ê´€ë ¨ì£¼ | +6% ~ +12% |
| ê¸€ë¡œë²Œí…Œí¬ | ë†’ìŒ | Big Tech ê´€ë ¨ì£¼ | +5% ~ +10% |
| ê¸ˆìœµ | ì¤‘ê°„ | Fed ì •ì±… ìˆ˜í˜œì£¼ | +3% ~ +7% |

---

âš ï¸ **íŠ¹ë³„ ì£¼ì˜ì‚¬í•­**: ë³¸ ë³´ê³ ì„œëŠ” ê¸€ë¡œë²Œ ë‰´ìŠ¤ ë°ì´í„°ë¥¼ í¬í•¨í•œ ì˜ˆì¸¡ ë¶„ì„ìž…ë‹ˆë‹¤.
   ë¯¸êµ­ ì‹œìž¥ ë³€ìˆ˜, í™˜ìœ¨ ë³€ë™, ì§€ì •í•™ì  ì´ìŠˆ ë“± ì™¸ë¶€ ìš”ì¸ì— ì˜í•´ 
   ì˜ˆì¸¡ì´ í¬ê²Œ ë³€ë™ë  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì‹¤ì œ íˆ¬ìžëŠ” ë°˜ë“œì‹œ ë³¸ì¸ì˜ íŒë‹¨ê³¼ 
   ì±…ìž„ í•˜ì— ì§„í–‰í•´ì•¼ í•©ë‹ˆë‹¤. ìˆ˜ìµì„ ë³´ìž¥í•˜ì§€ ì•Šìœ¼ë©°, ì†ì‹¤ ê°€ëŠ¥ì„±ì´ 
   í•­ìƒ ì¡´ìž¬í•©ë‹ˆë‹¤.

## ðŸ“ˆ ì˜ˆì¸¡ ì •í™•ë„ í–¥ìƒ ìš”ì¸

âœ… ê¸€ë¡œë²Œ ë°ì´í„° í¬í•¨: +25% ì •í™•ë„ í–¥ìƒ ê¸°ëŒ€  
âœ… ì‹¤ì‹œê°„ ì™¸ë¶€ ë³€ìˆ˜ ë°˜ì˜: Fed, í™˜ìœ¨, êµ­ì œ ì •ì„¸  
âœ… ë‹¤êµ­ì  ë‰´ìŠ¤ ì†ŒìŠ¤: êµ­ë‚´ì™¸ ì–¸ë¡ ì‚¬ ì¢…í•© ë¶„ì„  
âœ… ì„¹í„°ë³„ ì„¸ë¶„í™”: 11ê°œ ì„¹í„°ë¡œ ì„¸ë°€í•œ ë¶„ì„  
âœ… ë™ì  ê°€ì¤‘ì¹˜: ì‹œìž¥ ìƒí™©ì— ë”°ë¥¸ ìœ ì—°í•œ ì ìš©  

        """
        
    return report

def _format_enhanced_top_stocks(self, top_stocks: List[Dict]) -> str:
    """í–¥ìƒëœ TOP ì¢…ëª© í¬ë§·íŒ…"""
    formatted = ""
    for stock in top_stocks:
        formatted += f"""
### {stock['rank']}ìœ„: {stock['stock_name']}
- **ì˜ˆìƒ ì ìˆ˜**: {stock['score']}ì 
- **ì„ ì • ì´ìœ **: {stock['reason']}
- **ë§¤ìˆ˜ ì‹œì **: ì˜¤ì „ 9ì‹œ 00ë¶„-30ë¶„ (ê¸€ë¡œë²Œ ì‹œìž¥ í™•ì¸ í›„)
- **ì˜ˆìƒ ìˆ˜ìµë¥ **: +5% ~ +12% (ê¸€ë¡œë²Œ í˜¸ì¡° ë°˜ì˜)
"""
    return formatted

def _format_enhanced_full_ranking(self, all_stocks: List[Dict]) -> str:
    """í–¥ìƒëœ ì „ì²´ ëž­í‚¹ í¬ë§·íŒ…"""
    formatted = "| ìˆœìœ„ | ì¢…ëª©ëª… | ì ìˆ˜ | ê¸€ë¡œë²Œ ì˜í–¥ | ì„ ì • ì´ìœ  |\n"
    formatted += "|------|--------|------|----------|----------|\n"
    
    for stock in all_stocks:
        global_impact = "ë†’ìŒ" if stock['score'] > 30 else "ì¤‘ê°„" if stock['score'] > 20 else "ë³´í†µ"
        formatted += f"| {stock['rank']} | {stock['stock_name']} | {stock['score']} | {global_impact} | {stock['reason']} |\n"
            
    return formatted